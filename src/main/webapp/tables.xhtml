<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
   xmlns:p="http://primefaces.org/ui"
   template="/template.xhtml">
   
	<ui:define name="body">
	 <p:panel id="panelHall" header="#{msg.tables}" styleClass="welcomeTitle">
			<p:fieldset id="hall" legend="#{msg.hall}">
			 	<ui:repeat var="table" varStatus="tableIndex" value="#{tablesBean.tables}">
					 <p:outputPanel id="table_#{tableIndex.index}" style="position: relative;left:#{table.xPosition}px;top:#{table.yPosition}px" 
					 styleClass="tables #{table.type == 'R' ? 'rectangle' : 'circle'} #{table.invitedBy != null ? (table.invitedBy == groomsBean.groomName ? 'userTable' : 'partnerTable') : 'groomsTable'}">
					 	<p:commandButton style="background:transparent" styleClass="tables #{table.type == 'R' ? 'rectangle' : 'circle'} #{table.invitedBy != null ? (table.invitedBy == groomsBean.groomName ? 'userTable' : 'partnerTable') : 'groomsTable'}" value="#{table.number}" update="formaPanel:tableDetail" oncomplete="PF('tableOP').show('#{component.clientId}')">
                			<f:setPropertyActionListener value="#{table}" target="#{tablesBean.tableSelected}" />
            			</p:commandButton>
				 	</p:outputPanel>
					 <p:tooltip for="table_" value="#{table.name}" trackMouse="true" />
					 <p:draggable for="table_" />
					  
			 	</ui:repeat>
			  	<h:form id="formaPanel">
			 	<p:overlayPanel widgetVar="tableOP" styleClass="panelTable" showEffect="blind" dismissable="false" hideEffect="explode" dynamic="false" showCloseIcon="true">
				  	<p:outputPanel id="tableDetail">
				  		<h:outputText value="#{msg.name}"/>
					    <p:inputText value="#{tablesBean.tableSelected.name}"/>
					  	<h:outputText value="#{msg.number}"/>
					    <p:inputText value="#{tablesBean.tableSelected.number}"/>
					    <h:outputText value="#{msg.invitedBy}"/>
		        		<p:selectOneMenu rendered="#{tablesBean.tableSelected.invitedBy != null}" value="#{tablesBean.tableSelected.invitedBy}">
			   				<f:selectItems value="#{groomsBean.groomsList}" />
		   				</p:selectOneMenu>
		   				<h:outputText value="#{msg.tableType}"/>
		   				<p:selectOneMenu value="#{tablesBean.tableSelected.type}">
			   				<f:selectItems value="#{tablesBean.tableTypes}" />
		   				</p:selectOneMenu>
		   				<p:dataTable id="guestList" rows="5" paginatorPosition="bottom" value="#{guestBean.guestList}" var="guest">
				            <p:column headerText="#{msg.name}">
				                <h:outputText value="#{guest.name}"/>
				            </p:column>
				            <p:column headerText="#{msg.lastName}">
				                <h:outputText value="#{guest.lastName}"/>
				            </p:column>
		   				</p:dataTable>
		   				<p:commandButton value="#{msg.save}" update="hall"/>
	   				</p:outputPanel>
					  </p:overlayPanel>
		  	</h:form>
				 <p:droppable for="hall">
				 	<p:ajax listener="#{tablesBean.onDrop}" />
				 </p:droppable>
			 </p:fieldset>
	</p:panel>
	</ui:define>
</ui:composition>